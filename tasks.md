# 考核系统实现任务清单

> 基于数据库设计文档生成的完整实现任务
> 数据库表：exams, questions, assessment_plans, assessment_results, answer_records

---

## 阶段一：数据库设计与初始化 ✅

### 任务 1.1：创建数据库表结构
- [x] 创建 exams 表（试卷表）
- [x] 创建 questions 表（题目表）
- [x] 创建 assessment_plans 表（考核计划表）
- [x] 创建 assessment_results 表（考核结果表）
- [x] 创建 answer_records 表（答题记录表）
- [x] 设置表索引和外键约束
- [x] 添加初始测试数据

### 任务 1.2：数据库脚本准备
- [x] 编写数据库创建脚本
- [x] 编写数据库更新脚本
- [x] 测试数据库脚本执行

**状态：** ✅ 已完成
**预估时间：** 1天

---

## 阶段二：后端 API 开发

### 任务 2.1：试卷管理 API

#### 2.1.1 获取试卷列表
- [x] **GET /api/exams**





  - 支持分页参数（page, pageSize）
  - 支持筛选（category, difficulty, status）
  - 支持搜索（title 模糊查询）
  - 返回字段：id, title, category, difficulty, duration, total_score, pass_score, question_count, status, created_at
  - 按创建时间倒序排列

#### 2.1.2 获取试卷详情
- [x] **GET /api/exams/:id**







  - 返回试卷完整信息
  - 包含题目数量统计（按题型分组）
  - 不包含题目内容和答案（防止泄题）
  - 包含创建人信息

#### 2.1.3 创建试卷
- [x] **POST /api/exams**





  - 必填字段验证：title, duration, total_score, pass_score
  - 可选字段：description, category, difficulty
  - 设置 created_by 为当前用户
  - 默认 status 为 'draft'
  - 默认 question_count 为 0
  - 返回创建的试卷 ID

#### 2.1.4 更新试卷
- [x] **PUT /api/exams/:id**





  - 验证试卷状态（published 状态限制修改）
  - 可更新字段：title, description, category, difficulty, duration, total_score, pass_score
  - 不可更新：question_count（自动计算）
  - 更新 updated_at 时间戳

#### 2.1.5 删除试卷
- [x] **DELETE /api/exams/:id**




  - 检查是否有关联的考核计划
  - 检查是否有考试记录
  - 级联删除相关题目
  - 返回删除结果

#### 2.1.6 更新试卷状态
- [x] **PUT /api/exams/:id/status**





  - 支持状态转换：draft -> published, published -> archived
  - 发布前验证：题目数量 > 0，总分匹配
  - 记录状态变更日志

**预估时间：** 1天
**优先级：** P0 核心功能

---

### 任务 2.2：题目管理 API

#### 2.2.1 获取试卷题目列表
- [x] **GET /api/exams/:examId/questions**








  - 按 order_num 升序排列
  - 支持题型筛选（type）
  - 管理员返回完整信息（含答案）
  - 考生不返回 correct_answer 字段
  - 返回题目统计信息

#### 2.2.2 获取题目详情
- [x] **GET /api/questions/:id**





  - 返回题目完整信息
  - 根据用户角色控制答案可见性
  - 包含所属试卷信息

#### 2.2.3 添加题目
- [x] **POST /api/exams/:examId/questions**




  - 验证题型：single_choice, multiple_choice, true_false, fill_blank, essay
  - 验证选项格式（JSON，选择题必填）
  - 验证正确答案格式
  - 自动设置 order_num（当前最大值 + 1）
  - 更新试卷的 question_c
ount 和 total_score
  - 返回创建的题目 ID

#### 2.2.4 更新题目
- [x] **PUT /api/questions/:id**





  - 验证试卷状态（published 限制修改）
  - 可更新所有字段
  - 重新计算试卷总分
  - 更新 updated_at

#### 2.2.5 删除题目
- [x] **DELETE /api/questions/:id**





  - 检查是否有答题记录
  - 更新试卷 question_count 和 total_score
  - 重新排序剩余题目的 order_num

#### 2.2.6 题目排序
- [x] **PUT /api/exams/:examId/questions/reorder**





  - 接收题目 ID 数组
  - 批量更新 order_num
  - 验证所有题目归属于该试卷

**预估时间：** 1天
**优先级：** P0 核心功能

---

### 任务 2.3：考核计划 API

#### 2.3.1 获取考核计划列表
- [x] **GET /api/assessment-plans**






  - 支持分页
  - 支持状态筛选：draft, published, ongoing, completed, cancelled
  - 支持时间范围筛选（start_time, end_time）
  - 返回计划基本信息和参与统计
  - 包含试卷标题

#### 2.3.2 获取计划详情
- [x] **GET /api/assessment-plans/:id**







  - 返回计划完整信息
  - 包含试卷详细信息
  - 解析 target_users JSON 返回用户列表
  - 统计完成情况（已完成/总人数）
  - 统计通过率

#### 2.3.3 创建考核计划
- [x] **POST /api/assessment-plans**





  - 必填字段：title, exam_id, start_time, end_time
  - 验证试卷状态（必须是 published）
  - 验证时间范围（start_time < end_time）
  - 验证 target_users（JSON 数组格式）
  - 默认 max_attempts 为 1
  - 默认 status 为 'draft'
  - 设置 created_by

#### 2.3.4 更新考核计划
- [x] **PUT /api/assessment-plans/:id**






  - 验证计划状态（ongoing/completed 限制修改）
  - 可更新字段：title, description, start_time, end_time, target_users, max_attempts
  - 不可更新：exam_id

#### 2.3.5 删除考核计划
- [x] **DELETE /api/assessment-plans/:id**





  - 检查计划状态（ongoing/completed 不可删除）
  - 检查是否有考试记录
  - 级联删除相关 assessment_results 和 answer_records

#### 2.3.6 更新计划状态
- [x] **PUT /api/assessment-plans/:id/status**



  - 支持状态转换
  - draft -> published（发布）
  - published -> ongoing（自动或手动开始）
  - ongoing -> completed（自动或手动完成）
  - * -> cancelled（取消）

#### 2.3.7 获取参与者列表
- [x] **GET /api/assessment-plans/:id/participants**






  - 返回 target_users 中的用户信息
  - 返回每个用户的完成状态
  - 返回考试成绩和尝试次数
  - 支持筛选（已完成/未完成）

**预估时间：** 1.5天
**优先级：** P0 核心功能

---

### 任务 2.4：考试参与 API

#### 2.4.1 获取我的考试列表
- [x] **GET /api/my-exams**





  - 根据 assessment_plans.target_users 筛选
  - 返回当前用户可参加的考试
  - 显示考试状态（未开始、进行中、已结束）
  - 显示剩余尝试次数
  - 显示最佳成绩

#### 2.4.2 开始考试
- [x] **POST /api/assessment-results/start**






  - 参数：plan_id
  - 验证考核计划状态和时间
  - 验证用户在 target_users 中
  - 验证尝试次数限制
  - 创建 assessment_results 记录
  - 设置 status 为 'in_progress'
  - 记录 start_time
  - 返回试卷题目（不含 correct_answer）
  - 返回 result_id 用于后续操作

#### 2.4.3 获取考试进度
- [ ] **GET /api/assessment-results/:id**
  - 验证用户权限（只能查看自己的）
  - 返回考试基本信息
  - 返回已保存的答案
  - 计算剩余时间
  - 返回答题进度

#### 2.4.4 保存答案
- [ ] **PUT /api/assessment-results/:id/answer**
  - 参数：question_id, user_answer
  - 验证考试状态（in_progress）
  - 验证考试时间（未超时）
  - 创建或更新 answer_records
  - 自动保存，不评分
  - 返回保存状态

#### 2.4.5 提交考试
- [ ] **POST /api/assessment-results/:id/submit**
  - 验证考试状态（in_progress）
  - 更新 submit_time
  - 计算 duration（秒）
  - 自动评分客观题（single_choice, multiple_choice, true_false）
  - 填空题关键词匹配评分
  - 主观题标记待评分（is_correct = NULL）
  - 计算总分 score
  - 判断是否通过 is_passed
  - 更新状态为 'submitted' 或 'graded'
  - 返回考试结果

#### 2.4.6 查看考试结果
- [ ] **GET /api/assessment-results/:id/result**
  - 验证用户权限
  - 返回考试成绩
  - 返回答题详情
  - 返回正确答案和解析
  - 返回错题列表
  - 返回排名信息

**预估时间：** 2天
**优先级：** P0 核心功能

---

### 任务 2.5：成绩管理 API

#### 2.5.1 获取我的考试记录
- [ ] **GET /api/my-results**
  - 返回当前用户的所有考试记录
  - 支持分页和排序
  - 支持状态筛选
  - 显示成绩、通过状态、考试时间

#### 2.5.2 获取所有考试记录（管理员）
- [ ] **GET /api/assessment-results**
  - 支持多条件筛选：user_id, exam_id, plan_id, 时间范围
  - 支持分页和排序
  - 返回详细成绩信息
  - 包含用户和试卷信息

#### 2.5.3 人工评分（主观题）
- [ ] **PUT /api/assessment-results/:id/grade**
  - 验证管理员权限
  - 参数：question_id, score, is_correct
  - 更新 answer_records 的分数
  - 重新计算总分
  - 更新 is_passed 状态
  - 更新考试状态为 'graded'

#### 2.5.4 获取答题详情
- [ ] **GET /api/assessment-results/:id/answers**
  - 返回所有题目和用户答案
  - 显示正确答案和解析
  - 显示每题得分和正确性
  - 验证用户权限

**预估时间：** 1天
**优先级：** P1 重要功能

---

### 任务 2.6：统计分析 API

#### 2.6.1 考试概览统计
- [ ] **GET /api/statistics/exam-overview**
  - 总考试次数
  - 平均分
  - 总通过率
  - 参与人数
  - 支持时间范围筛选

#### 2.6.2 单个试卷统计
- [ ] **GET /api/statistics/exam/:examId**
  - 参加人数
  - 平均分、最高分、最低分
  - 通过率
  - 题目正确率分析
  - 分数分布（0-60, 60-70, 70-80, 80-90, 90-100）

#### 2.6.3 用户考试统计
- [ ] **GET /api/statistics/user/:userId**
  - 参加考试次数
  - 平均分
  - 通过率
  - 考试历史记录
  - 成绩趋势数据

#### 2.6.4 部门成绩对比
- [ ] **GET /api/statistics/department**
  - 各部门平均分
  - 各部门通过率
  - 各部门参与率
  - 支持时间范围和试卷筛选

#### 2.6.5 题目分析
- [ ] **GET /api/statistics/questions/:examId**
  - 每题正确率
  - 每题平均得分
  - 易错题排行（TOP 10）
  - 答题时间分析

#### 2.6.6 考试排名
- [ ] **GET /api/statistics/ranking**
  - 支持按试卷或计划筛选
  - 返回成绩排名
  - 支持分页
  - 显示用户信息和成绩

**预估时间：** 1.5天
**优先级：** P1 重要功能

**后端 API 总预估时间：** 7-8天

---

## 阶段三：前端页面开发

### 任务 3.1：试卷管理页面

#### 3.1.1 试卷列表页面
- [ ] 创建 ExamList.jsx 组件
- [ ] 实现卡片/表格视图切换
- [ ] 显示试卷信息（标题、分类、难度、状态、题目数）
- [ ] 实现筛选功能（分类、难度、状态）
- [ ] 实现搜索功能（标题模糊搜索）
- [ ] 实现分页功能
- [ ] 添加操作按钮（编辑、删除、查看详情、发布/归档）
- [ ] 状态标签样式（draft-灰色、published-绿色、archived-橙色）

#### 3.1.2 试卷创建/编辑表单
- [ ] 创建 ExamForm.jsx 组件
- [ ] 基本信息表单
  - 试卷标题（必填，最多200字符）
  - 试卷描述（可选，富文本）
  - 分类选择（下拉框）
  - 难度选择（easy/medium/hard）
- [ ] 考试配置
  - 考试时长（分钟，必填）
  - 总分（必填，自动计算提示）
  - 及格分（必填，不能大于总分）
- [ ] 表单验证
- [ ] 保存草稿功能
- [ ] 发布功能（验证题目数量）
- [ ] 编辑模式支持

#### 3.1.3 试卷详情页面
- [ ] 创建 ExamDetail.jsx 组件
- [ ] 显示试卷基本信息卡片
- [ ] 显示考试配置信息
- [ ] 显示题目列表（按题型分组）
- [ ] 题目管理功能区
  - 添加题目按钮
  - 批量导入按钮
  - 题目排序按钮
- [ ] 试卷预览功能
- [ ] 统计信息（使用次数、平均分、通过率）
- [ ] 返回列表按钮

#### 3.1.4 拖拽创建试卷功能
- [ ] 创建 DragDropExamBuilder.jsx 组件
- [ ] 实现题库区域
  - 显示可用题目列表
  - 支持按题型筛选
  - 支持搜索功能
  - 题目卡片显示（题型、内容预览、分值）
- [ ] 实现试卷构建区域
  - 拖放目标区域
  - 显示已添加题目列表
  - 实时显示题目数量和总分
  - 按题型分组显示
- [ ] 实现拖拽功能
  - 使用 react-beautiful-dnd 或 @dnd-kit/core
  - 从题库拖拽题目到试卷区域
  - 试卷内题目重新排序
  - 拖拽时显示视觉反馈
  - 拖拽完成后更新状态
- [ ] 题目操作功能
  - 从试卷中移除题目
  - 修改题目分值
  - 调整题目顺序
  - 批量添加题目
- [ ] 试卷配置面板
  - 试卷基本信息输入
  - 总分自动计算
  - 及格分设置
  - 考试时长设置
- [ ] 保存和预览
  - 保存试卷草稿
  - 预览试卷效果
  - 发布试卷
  - 数据验证（题目数量、总分等）

**预估时间：** 4天
**优先级：** P0 核心功能

---

### 任务 3.2：题目管理页面

#### 3.2.1 题目列表组件
- [ ] 创建 QuestionList.jsx 组件
- [ ] 显示题目列表（可折叠）
- [ ] 题型图标标识（不同颜色）
- [ ] 显示题目内容（截断显示）
- [ ] 显示分值
- [ ] 拖拽排序功能（react-beautiful-dnd）
- [ ] 快速编辑按钮
- [ ] 删除确认对话框

#### 3.2.2 题目编辑器
- [ ] 创建 QuestionEditor.jsx 组件
- [ ] 题型选择（单选、多选、判断、填空、简答）
- [ ] 单选题编辑器
  - 题目内容输入（富文本）
  - 选项管理（添加/删除，最少2个最多10个）
  - 正确答案单选
  - 分值设置
  - 解析输入
- [ ] 多选题编辑器
  - 正确答案多选
  - 至少选择2个正确答案
- [ ] 判断题编辑器
  - 正确/错误单选
- [ ] 填空题编辑器
  - 支持多个空格
  - 关键词设置（用于自动评分）
- [ ] 简答题编辑器
  - 参考答案输入
  - 评分标准说明
- [ ] 实时预览功能
- [ ] 图片上传支持

#### 3.2.3 批量导入功能
- [ ] 创建 QuestionImport.jsx 组件
- [ ] Excel 模板下载
- [ ] 文件上传（支持 .xlsx）
- [ ] 数据解析和验证
- [ ] 导入预览表格
- [ ] 错误提示和修正
- [ ] 批量导入确认

**预估时间：** 3天
**优先级：** P0 核心功能

---

### 任务 3.3：考核计划页面

#### 3.3.1 计划列表页面
- [ ] 创建 AssessmentPlanList.jsx 组件
- [ ] 显示计划列表（表格视图）
- [ ] 状态标识（不同颜色徽章）
- [ ] 时间范围显示
- [ ] 参与情况统计（已完成/总人数）
- [ ] 通过率显示
- [ ] 操作按钮（编辑、删除、查看详情、发布）
- [ ] 筛选功能（状态、时间范围）

#### 3.3.2 计划创建/编辑表单
- [ ] 创建 AssessmentPlanForm.jsx 组件
- [ ] 基本信息
  - 计划标题（必填）
  - 计划描述（可选）
- [ ] 试卷选择
  - 下拉框选择（只显示已发布的试卷）
  - 显示试卷信息预览
- [ ] 时间范围选择
  - 开始时间（日期时间选择器）
  - 结束时间（日期时间选择器）
  - 时间验证
- [ ] 目标用户选择
  - 用户多选（支持搜索）
  - 部门选择（选择整个部门）
  - 已选用户列表显示
- [ ] 尝试次数设置（默认1次）
- [ ] 表单验证
- [ ] 保存草稿/发布

#### 3.3.3 计划详情页面
- [ ] 创建 AssessmentPlanDetail.jsx 组件
- [ ] 显示计划基本信息
- [ ] 显示试卷信息卡片
- [ ] 参与者列表表格
  - 用户信息
  - 完成状态
  - 考试成绩
  - 尝试次数
  - 操作（查看详情）
- [ ] 完成情况统计
  - 总人数、已完成、未完成
  - 通过率
  - 平均分
- [ ] 成绩分布图表（柱状图）
- [ ] 导出功能（Excel）

**预估时间：** 2天
**优先级：** P0 核心功能

---

### 任务 3.4：考试参与页面

#### 3.4.1 我的考试列表
- [ ] 创建 MyExamList.jsx 组件
- [ ] 显示可参加的考试列表
- [ ] 考试信息卡片
  - 考试标题
  - 难度标签
  - 时长、题目数、及格分
  - 考试时间范围
  - 剩余尝试次数
- [ ] 考试状态标识
  - 未开始（灰色，显示开始时间）
  - 进行中（绿色，显示"开始考试"按钮）
  - 已结束（橙色，显示"查看成绩"按钮）
- [ ] 历史记录入口
- [ ] 筛选功能（状态）

#### 3.4.2 考试须知页面
- [ ] 创建 ExamInstructions.jsx 组件
- [ ] 显示考试规则
  - 考试时长
  - 题目数量
  - 总分和及格分
  - 尝试次数
- [ ] 注意事项列表
  - 考试期间不可切换页面
  - 答案自动保存
  - 超时自动提交
- [ ] 确认开始按钮
- [ ] 取消返回按钮

#### 3.4.3 答题页面
- [ ] 创建 ExamTaking.jsx 组件
- [ ] 顶部工具栏
  - 考试标题
  - 倒计时显示（大字体，红色警告）
  - 题目进度（已答/总数）
  - 提交按钮
- [ ] 侧边题目导航
  - 题号列表（网格布局）
  - 已答标识（绿色）
  - 未答标识（灰色）
  - 标记功能（星标）
  - 快速跳转
- [ ] 题目显示区域
  - 题号和题型标识
  - 题目内容（支持富文本和图片）
  - 分值显示
- [ ] 答案选择/输入区域
  - 单选题（Radio）
  - 多选题（Checkbox）
  - 判断题（Radio）
  - 填空题（Input）
  - 简答题（Textarea）
- [ ] 答题控制
  - 上一题按钮
  - 下一题按钮
  - 标记题目按钮
  - 自动保存提示（防抖3秒）
- [ ] 时间提醒
  - 5分钟提醒（通知）
  - 1分钟提醒（警告）
  - 超时自动提交
- [ ] 提交确认对话框
  - 显示未答题目数量
  - 确认/取消按钮

#### 3.4.4 考试结果页面
- [ ] 创建 ExamResult.jsx 组件
- [ ] 成绩卡片
  - 总分和得分（大字体）
  - 通过状态（通过-绿色、未通过-红色）
  - 正确率
  - 用时
  - 排名
- [ ] 答题统计
  - 各题型正确率（饼图）
  - 得分分布
- [ ] 操作按钮
  - 查看答题详情
  - 返回列表
  - 再次考试（如有剩余次数）

**预估时间：** 3天
**优先级：** P0 核心功能

---

### 任务 3.5：成绩管理页面

#### 3.5.1 我的成绩页面
- [ ] 创建 MyResults.jsx 组件
- [ ] 显示考试记录列表（表格）
  - 考试名称
  - 考试时间
  - 成绩
  - 通过状态
  - 用时
  - 操作（查看详情）
- [ ] 筛选功能
  - 按状态筛选
  - 按时间范围筛选
- [ ] 排序功能（时间、成绩）
- [ ] 分页功能

#### 3.5.2 答题详情页面
- [ ] 创建 AnswerDetail.jsx 组件
- [ ] 显示考试信息头部
- [ ] 显示所有题目
  - 题号和题型
  - 题目内容
  - 用户答案（高亮显示）
  - 正确答案
  - 得分情况
  - 答案解析
  - 错题标识（红色边框）
- [ ] 题目导航（侧边栏）
- [ ] 打印功能
- [ ] 返回按钮

#### 3.5.3 成绩管理页面（管理员）
- [ ] 创建 ResultManagement.jsx 组件
- [ ] 显示所有考试记录（表格）
  - 用户信息
  - 考试信息
  - 成绩
  - 状态
  - 操作
- [ ] 多条件筛选
  - 用户选择
  - 试卷选择
  - 计划选择
  - 时间范围
  - 状态
- [ ] 批量操作
  - 批量导出
  - 批量评分
- [ ] 人工评分功能（主观题）
  - 打开评分对话框
  - 显示题目和用户答案
  - 输入分数
  - 保存评分
- [ ] 导出功能（Excel）

**预估时间：** 2天
**优先级：** P1 重要功能

---

### 任务 3.6：统计分析页面

#### 3.6.1 考试统计仪表板
- [ ] 创建 ExamStatistics.jsx 组件
- [ ] 总体统计卡片
  - 总考试次数
  - 平均分
  - 总通过率
  - 参与人数
- [ ] 成绩趋势图表（折线图）
  - 按月统计
  - 平均分趋势
  - 通过率趋势
- [ ] 部门对比图表（柱状图）
  - 各部门平均分
  - 各部门通过率
- [ ] 热门考试排行（表格）
  - 参与人数最多
  - 通过率最高/最低
- [ ] 时间范围筛选（日期选择器）

#### 3.6.2 试卷分析页面
- [ ] 创建 ExamAnalysis.jsx 组件
- [ ] 试卷基本信息卡片
- [ ] 参与统计
  - 参加人数
  - 平均分、最高分、最低分
  - 通过率
- [ ] 成绩分布图（柱状图）
  - 0-60, 60-70, 70-80, 80-90, 90-100
- [ ] 题目正确率分析（表格）
  - 题号
  - 题型
  - 正确率
  - 平均得分
- [ ] 易错题排行（TOP 10）
- [ ] 答题时间分析

#### 3.6.3 用户成绩分析
- [ ] 创建 UserAnalysis.jsx 组件
- [ ] 个人成绩概览卡片
  - 参加考试次数
  - 平均分
  - 通过率
  - 最佳成绩
- [ ] 成绩趋势图（折线图）
  - 按时间显示成绩变化
- [ ] 强弱项分析（雷达图）
  - 按题型统计正确率
- [ ] 考试历史记录（时间轴）
- [ ] 与平均分对比（柱状图）

**预估时间：** 2天
**优先级：** P1 重要功能

**前端页面总预估时间：** 16天

---

## 阶段四：核心功能实现

### 任务 4.1：考试倒计时功能
- [ ] 创建 ExamTimer.jsx 组件
- [ ] 实现倒计时逻辑
  - 使用 setInterval 每秒更新
  - 格式化显示（HH:MM:SS）
- [ ] 服务器时间同步
  - 获取服务器时间
  - 计算时间差
  - 校正本地时间
- [ ] 时间提醒
  - 5分钟提醒（Notification API）
  - 1分钟提醒（警告样式）
  - 倒计时变红色
- [ ] 超时处理
  - 自动提交考试
  - 禁用答题
  - 显示超时提示
- [ ] 页面切换处理
  - 暂停倒计时（可选）
  - 记录切换次数
  - 警告提示

**预估时间：** 1天
**优先级：** P0 核心功能

---

### 任务 4.2：答案自动保存
- [ ] 创建 AutoSave.jsx Hook
- [ ] 实现防抖保存机制
  - 使用 lodash.debounce
  - 延迟3秒保存
- [ ] LocalStorage 本地缓存
  - 保存答案到本地
  - 页面刷新恢复答案
  - 提交后清除缓存
- [ ] 定时同步到服务器
  - 每30秒同步一次
  - 失败重试机制
- [ ] 网络异常处理
  - 检测网络状态
  - 离线提示
  - 恢复后自动同步
- [ ] 保存状态提示
  - 保存中（loading）
  - 保存成功（success）
  - 保存失败（error）

**预估时间：** 1天
**优先级：** P0 核心功能

---

### 任务 4.3：自动评分算法
- [ ] 创建评分服务 gradingService.js
- [ ] 单选题评分
  - 完全匹配正确答案
  - 正确得满分，错误得0分
- [ ] 多选题评分
  - 完全正确得满分
  - 部分正确得部分分（可选）
  - 有错误选项得0分
- [ ] 判断题评分
  - 完全匹配正确答案
- [ ] 填空题评分
  - 关键词匹配
  - 支持多个关键词（OR 关系）
  - 忽略大小写和空格
  - 部分匹配得部分分
- [ ] 主观题处理
  - 标记为待评分
  - is_correct = NULL
  - score = NULL
  - 等待人工评分

**预估时间：** 1天
**优先级：** P0 核心功能

---

### 任务 4.4：题目导航功能
- [ ] 创建 QuestionNav.jsx 组件
- [ ] 题号列表显示
  - 网格布局（5列）
  - 题号按钮
- [ ] 状态标识
  - 未答（灰色边框）
  - 已答（绿色背景）
  - 当前题（蓝色边框）
  - 标记题（星标图标）
- [ ] 快速跳转
  - 点击题号跳转
  - 平滑滚动
- [ ] 答题进度显示
  - 进度条
  - 已答/总数
  - 百分比
- [ ] 标记功能
  - 点击星标标记
  - 标记列表筛选

**预估时间：** 0.5天
**优先级：** P1 重要功能

---

### 任务 4.5：防作弊机制
- [ ] 页面切换检测
  - 监听 visibilitychange 事件
  - 记录切换次数
  - 超过3次警告
  - 记录到日志
- [ ] 复制粘贴限制
  - 禁用复制（可选）
  - 禁用粘贴
  - 右键菜单禁用
- [ ] 考试日志记录
  - 记录开始时间
  - 记录每题答题时间
  - 记录页面切换
  - 记录异常行为
- [ ] 异常行为提醒
  - 切换页面警告
  - 长时间未操作提醒
  - 可疑行为标记

**预估时间：** 1天
**优先级：** P2 增强功能

**核心功能总预估时间：** 4.5天

---

## 阶段五：用户体验优化

### 任务 5.1：响应式设计
- [ ] 移动端适配（< 768px）
  - 题目导航改为底部抽屉
  - 答题区域全屏显示
  - 按钮大小调整
- [ ] 平板端适配（768px - 1024px）
  - 侧边栏宽度调整
  - 字体大小优化
- [ ] 不同分辨率适配
  - 使用相对单位（rem, em）
  - 媒体查询
- [ ] 触摸操作优化
  - 增大点击区域
  - 滑动切换题目
  - 手势支持

**预估时间：** 1天
**优先级：** P2 增强功能

---

### 任务 5.2：加载优化
- [ ] 题目分页加载
  - 虚拟滚动
  - 懒加载题目
- [ ] 图片懒加载
  - 使用 Intersection Observer
  - 占位图显示
- [ ] 组件懒加载
  - React.lazy
  - Suspense
- [ ] 骨架屏加载
  - 列表骨架屏
  - 详情页骨架屏
- [ ] 加载进度提示
  - 进度条
  - 加载动画

**预估时间：** 1天
**优先级：** P2 增强功能

---

### 任务 5.3：交互优化
- [ ] 操作确认对话框
  - 删除确认
  - 提交确认
  - 取消确认
- [ ] 成功/失败提示
  - Toast 通知
  - 成功动画
  - 错误提示
- [ ] 加载状态提示
  - 按钮 loading 状态
  - 全局 loading
- [ ] 错误提示优化
  - 友好的错误信息
  - 错误恢复建议
- [ ] 快捷键支持
  - 上一题（←）
  - 下一题（→）
  - 提交（Ctrl+Enter）
  - 标记（Space）

**预估时间：** 1天
**优先级：** P2 增强功能

---

### 任务 5.4：数据可视化
- [ ] 选择图表库（Chart.js 或 ECharts）
- [ ] 成绩分布图表
  - 柱状图
  - 数据格式化
  - 交互提示
- [ ] 趋势分析图表
  - 折线图
  - 多系列数据
  - 时间轴
- [ ] 部门对比图表
  - 分组柱状图
  - 颜色区分
- [ ] 题目分析图表
  - 饼图
  - 雷达图
- [ ] 图表交互功能
  - 点击查看详情
  - 缩放
  - 导出图片

**预估时间：** 1.5天
**优先级：** P1 重要功能

**用户体验优化总预估时间：** 4.5天

---

## 阶段六：测试与优化

### 任务 6.1：功能测试
- [ ] 试卷管理功能测试
  - 创建、编辑、删除
  - 发布、归档
  - 边界情况
- [ ] 题目管理功能测试
  - 各题型添加
  - 编辑、删除
  - 排序
  - 批量导入
- [ ] 考核计划功能测试
  - 创建、编辑
  - 用户选择
  - 时间验证
- [ ] 考试参与功能测试
  - 开始考试
  - 答题保存
  - 提交评分
  - 超时处理
- [ ] 成绩管理功能测试
  - 成绩查看
  - 人工评分
  - 导出功能
- [ ] 统计分析功能测试
  - 各类统计数据
  - 图表显示
  - 数据准确性

**预估时间：** 2天
**优先级：** P0 核心功能

---

### 任务 6.2：性能测试
- [ ] API 响应时间测试
  - 使用 Postman 或 JMeter
  - 测试各接口响应时间
  - 优化慢查询
- [ ] 并发考试测试
  - 模拟多用户同时考试
  - 测试服务器负载
  - 数据库连接池优化
- [ ] 大数据量测试
  - 测试大量题目加载
  - 测试大量考试记录
  - 分页性能
- [ ] 内存泄漏检测
  - 使用 Chrome DevTools
  - 检查组件卸载
  - 清理定时器和监听器
- [ ] 数据库查询优化
  - 添加必要索引
  - 优化复杂查询
  - 使用 EXPLAIN 分析

**预估时间：** 2天
**优先级：** P1 重要功能

---

### 任务 6.3：安全测试
- [ ] 权限控制测试
  - 测试各角色权限
  - 测试越权访问
  - API 权限验证
- [ ] SQL 注入测试
  - 测试输入验证
  - 使用参数化查询
- [ ] XSS 攻击测试
  - 测试输入过滤
  - 输出转义
- [ ] CSRF 攻击测试
  - CSRF Token 验证
- [ ] 数据加密测试
  - 密码加密
  - 敏感数据加密
  - HTTPS 传输

**预估时间：** 1天
**优先级：** P1 重要功能

---

### 任务 6.4：兼容性测试
- [ ] 浏览器兼容性测试
  - Chrome
  - Firefox
  - Safari
  - Edge
- [ ] 移动设备测试
  - iOS Safari
  - Android Chrome
  - 微信浏览器
- [ ] 不同网络环境测试
  - 4G
  - 3G
  - 弱网
  - 离线
- [ ] 数据库版本兼容性
  - MySQL 5.7
  - MySQL 8.0

**预估时间：** 1天
**优先级：** P2 增强功能

**测试与优化总预估时间：** 6天

---

## 阶段七：文档与部署

### 任务 7.1：技术文档
- [ ] API 接口文档
  - 使用 Swagger/OpenAPI
  - 接口说明
  - 参数说明
  - 返回值说明
  - 示例代码
- [ ] 数据库设计文档
  - ER 图
  - 表结构说明
  - 索引说明
  - 关系说明
- [ ] 系统架构文档
  - 架构图
  - 技术栈说明
  - 模块划分
  - 数据流程
- [ ] 部署文档
  - 环境要求
  - 安装步骤
  - 配置说明
  - 常见问题

**预估时间：** 1.5天
**优先级：** P1 重要功能

---

### 任务 7.2：用户文档
- [ ] 管理员使用手册
  - 试卷管理
  - 题目管理
  - 考核计划
  - 成绩管理
  - 统计分析
- [ ] 考生使用手册
  - 如何参加考试
  - 答题技巧
  - 成绩查看
  - 常见问题
- [ ] 常见问题解答（FAQ）
  - 功能问题
  - 技术问题
  - 操作问题
- [ ] 操作视频教程
  - 录制操作视频
  - 视频剪辑
  - 上传发布

**预估时间：** 1.5天
**优先级：** P2 增强功能

---

### 任务 7.3：部署准备
- [ ] 生产环境配置
  - 环境变量配置
  - 数据库配置
  - 服务器配置
  - 域名配置
- [ ] 数据库迁移脚本
  - 编写迁移脚本
  - 测试迁移
  - 回滚方案
- [ ] 备份恢复方案
  - 数据库备份策略
  - 文件备份策略
  - 恢复测试
- [ ] 监控告警配置
  - 服务器监控
  - 应用监控
  - 错误告警
  - 性能监控

**预估时间：** 1天
**优先级：** P1 重要功能

---

### 任务 7.4：上线发布
- [ ] 灰度发布
  - 选择灰度用户
  - 部署灰度环境
  - 收集反馈
  - 修复问题
- [ ] 数据迁移
  - 备份现有数据
  - 执行迁移脚本
  - 验证数据完整性
- [ ] 用户培训
  - 组织培训会议
  - 演示系统功能
  - 解答用户问题
  - 收集用户反馈
- [ ] 上线监控
  - 实时监控系统状态
  - 监控错误日志
  - 监控性能指标
  - 及时处理问题

**预估时间：** 1天
**优先级：** P0 核心功能

**文档与部署总预估时间：** 5天

---

## 总体时间估算

| 阶段 | 内容 | 预估时间 | 优先级 |
|------|------|----------|--------|
| 阶段一 | 数据库设计与初始化 | 1天 | P0 ✅ |
| 阶段二 | 后端 API 开发 | 7-8天 | P0 |
| 阶段三 | 前端页面开发 | 16天 | P0 |
| 阶段四 | 核心功能实现 | 4.5天 | P0-P2 |
| 阶段五 | 用户体验优化 | 4.5天 | P1-P2 |
| 阶段六 | 测试与优化 | 6天 | P0-P2 |
| 阶段七 | 文档与部署 | 5天 | P0-P2 |
| **总计** | | **44-45天** | |

### 按优先级分类

**P0 - 核心功能（必须完成）：** 约 30天
- 数据库设计 ✅
- 后端 API（试卷、题目、计划、考试、成绩）
- 前端页面（管理、答题、成绩、拖拽创建试卷）
- 核心功能（倒计时、自动保存、评分）
- 功能测试
- 上线发布

**P1 - 重要功能（优先完成）：** 约 10天
- 统计分析 API
- 统计分析页面
- 数据可视化
- 性能测试
- 安全测试
- 技术文档

**P2 - 增强功能（后续完成）：** 约 5天
- 防作弊机制
- 响应式设计
- 加载优化
- 交互优化
- 兼容性测试
- 用户文档

---

## 实施建议

### 第一周（5天）
- ✅ 完成数据库设计
- 完成后端 API - 试卷管理
- 完成后端 API - 题目管理
- 开始前端试卷管理页面

### 第二周（5天）
- 完成后端 API - 考核计划
- 完成后端 API - 考试参与
- 完成前端试卷管理页面
- 完成前端题目管理页面

### 第三周（5天）
- 完成后端 API - 成绩管理
- 完成前端考核计划页面
- 开始前端考试参与页面

### 第四周（5天）
- 完成前端考试参与页面
- 实现核心功能（倒计时、自动保存、评分）
- 开始前端成绩管理页面

### 第五周（5天）
- 完成前端成绩管理页面
- 完成后端统计分析 API
- 开始前端统计分析页面

### 第六周（5天）
- 完成前端统计分析页面
- 实现数据可视化
- 用户体验优化

### 第七周（5天）
- 功能测试
- 性能测试
- 安全测试
- Bug 修复

### 第八周（5天）
- 兼容性测试
- 编写文档
- 部署准备
- 灰度发布
- 正式上线

---

## 技术栈

### 前端
- **框架：** React 18
- **UI 库：** Ant Design 5 / Material-UI
- **状态管理：** Redux Toolkit / Zustand
- **路由：** React Router 6
- **HTTP 客户端：** Axios
- **图表库：** Chart.js / ECharts
- **拖拽：** react-beautiful-dnd
- **富文本编辑器：** Quill / TinyMCE
- **日期处理：** Day.js
- **工具库：** Lodash

### 后端
- **运行时：** Node.js 18+
- **框架：** Express / Fastify
- **数据库：** MySQL 8.0+
- **ORM：** Sequelize / Prisma（可选）
- **认证：** JWT
- **文件上传：** Multer
- **Excel 处理：** ExcelJS
- **验证：** Joi / Yup

### 开发工具
- **IDE：** VS Code
- **API 测试：** Postman / Insomnia
- **数据库工具：** MySQL Workbench / DBeaver
- **版本控制：** Git
- **包管理：** npm / yarn / pnpm

### 部署
- **服务器：** Linux (Ubuntu/CentOS)
- **Web 服务器：** Nginx
- **进程管理：** PM2
- **容器化：** Docker（可选）

---

## 关键技术点

### 1. 考试倒计时
- 服务器时间同步
- 本地时间校正
- 定时器管理
- 超时自动提交

### 2. 答案自动保存
- 防抖机制
- LocalStorage 缓存
- 定时同步
- 网络异常处理

### 3. 自动评分
- 客观题自动评分
- 填空题关键词匹配
- 主观题人工评分
- 分数计算和统计

### 4. 题目导航
- 状态管理
- 快速跳转
- 进度显示
- 标记功能

### 5. 数据可视化
- 图表选择
- 数据格式化
- 交互设计
- 响应式适配

### 6. 性能优化
- 数据库索引
- 查询优化
- 前端懒加载
- 缓存策略

### 7. 安全性
- 权限控制
- 数据验证
- SQL 注入防护
- XSS 防护
- CSRF 防护

---

## 风险与挑战

### 技术风险
1. **并发考试性能** - 需要进行压力测试和优化
2. **时间同步准确性** - 需要可靠的时间同步机制
3. **答案丢失风险** - 需要多重保存机制
4. **评分算法准确性** - 需要充分测试各种情况

### 业务风险
1. **作弊问题** - 需要防作弊机制
2. **题目泄露** - 需要权限控制
3. **成绩争议** - 需要详细的答题记录
4. **用户体验** - 需要充分的用户测试

### 应对措施
1. 充分的测试（单元测试、集成测试、压力测试）
2. 完善的日志记录和监控
3. 定期备份和恢复演练
4. 用户培训和文档支持
5. 快速响应机制

---

## 成功标准

### 功能完整性
- ✅ 所有 P0 功能完成并测试通过
- ✅ 核心业务流程顺畅
- ✅ 无严重 Bug

### 性能指标
- ✅ API 响应时间 < 500ms
- ✅ 页面加载时间 < 3s
- ✅ 支持 100+ 并发考试

### 用户体验
- ✅ 界面友好直观
- ✅ 操作流畅无卡顿
- ✅ 错误提示清晰

### 安全性
- ✅ 通过安全测试
- ✅ 权限控制完善
- ✅ 数据加密传输

### 文档完整性
- ✅ 技术文档完整
- ✅ 用户手册清晰
- ✅ API 文档详细

---

## 后续优化方向

### 功能增强
1. 题目批量导入优化
2. 随机抽题功能
3. 考试模板功能
4. 题目标签系统
5. 智能组卷功能

### 性能优化
1. 数据库读写分离
2. Redis 缓存
3. CDN 加速
4. 图片压缩优化

### 用户体验
1. 移动端 App
2. 微信小程序
3. 语音答题
4. AI 智能推荐

### 数据分析
1. 学习路径分析
2. 知识图谱
3. 个性化推荐
4. 预测分析

---

**文档版本：** v1.0
**创建日期：** 2024-11-12
**最后更新：** 2024-11-12
**维护人员：** 开发团队
