# 客服管理系统完整部署安装指南

## 概述
本文档详细说明如何在多台电脑上部署客服管理系统，实现文件共享和统一数据库访问。

## 部署架构
- 1台数据库服务器（MySQL）
- 1台后端服务服务器（运行Node.js后端）
- 多台客户端电脑（运行桌面应用）
- 1个网络共享文件夹（用于文件共享）

## 第一步：准备环境

### 1.1 安装MySQL数据库
在数据库服务器上安装MySQL 5.7或更高版本：
1. 下载MySQL安装包
2. 安装MySQL服务
3. 记录数据库IP地址、端口、用户名和密码

### 1.2 安装Node.js（仅后端服务器需要）
在后端服务服务器上安装Node.js 16或更高版本：
1. 下载Node.js安装包
2. 运行安装程序
3. 验证安装：`node --version`

## 第二步：配置数据库

### 2.1 创建数据库
```sql
CREATE DATABASE leixin_customer_service CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 2.2 初始化数据库结构
在项目根目录运行：
```bash
npm run db:init
```

## 第三步：设置文件共享

### 3.1 选择文件服务器
选择一台稳定的电脑作为文件服务器（例如名为SONG的电脑）。

### 3.2 创建共享文件夹
1. 在文件服务器上创建文件夹：`D:\SharedUploads`
2. 右键文件夹 → 属性 → 共享
3. 点击"共享"按钮
4. 选择"Everyone"用户
5. 设置权限为"读取/写入"
6. 记住共享路径，例如：`\\SONG\SharedUploads`

### 3.3 配置网络访问
1. 启用网络发现：
   - 控制面板 → 网络和Internet → 网络和共享中心
   - 更改高级共享设置
   - 启用"网络发现"和"文件和打印机共享"
2. 配置防火墙：
   - 控制面板 → 系统和安全 → Windows Defender防火墙
   - 允许应用通过防火墙
   - 确保"文件和打印机共享"被勾选

## 第四步：配置后端服务

### 4.1 复制项目文件
将整个项目文件夹复制到后端服务服务器。

### 4.2 配置数据库连接
编辑 `config/db-config.json` 文件：
```json
{
  "database": {
    "host": "192.168.1.100",    // 数据库服务器IP
    "port": 3306,               // 数据库端口
    "user": "root",             // 数据库用户名
    "password": "your_password", // 数据库密码
    "database": "leixin_customer_service" // 数据库名称
  },
  "upload": {
    "sharedDirectory": "\\\\SONG\\SharedUploads",  // 网络共享文件夹（注意使用双反斜杠）
    "publicUrl": "http://192.168.1.101:3001"      // 后端服务地址
  }
}
```

### 4.3 安装依赖
在项目根目录运行：
```bash
npm install
```

### 4.4 启动后端服务
```bash
npm run server
```

## 第五步：配置客户端电脑

### 5.1 复制项目文件
将整个项目文件夹复制到每台客户端电脑。

### 5.2 配置连接信息
在每台客户端电脑上编辑 `config/db-config.json` 文件：
```json
{
  "database": {
    "host": "192.168.1.100",    // 数据库服务器IP
    "port": 3306,
    "user": "root",
    "password": "your_password",
    "database": "leixin_customer_service"
  },
  "upload": {
    "sharedDirectory": "\\\\SONG\\SharedUploads",  // 网络共享文件夹（注意使用双反斜杠）
    "publicUrl": "http://192.168.1.101:3001"      // 后端服务地址
  }
}
```

### 5.3 测试网络共享访问
在每台客户端电脑上：
1. 打开文件资源管理器
2. 地址栏输入：`\\FileServer\SharedUploads`
3. 确保可以正常访问

## 第六步：运行应用

### 6.1 运行桌面应用
在每台客户端电脑上：
- 双击 `dist-app/win-unpacked/客服管理系统.exe` 运行应用
- 或运行安装程序：`dist-app/客服管理系统 Setup 1.0.0.exe`

### 6.2 登录系统
使用默认管理员账号登录：
- 用户名：admin
- 密码：123456

## 第七步：验证部署

### 7.1 测试功能
1. 在一台电脑上上传文件
2. 在另一台电脑上检查是否能看到该文件
3. 测试员工管理、考勤等功能

### 7.2 检查日志
查看后端服务日志，确保没有错误信息。

## 常见问题解决

### 问题1：无法访问网络共享文件夹
**解决方案**：
1. 检查网络连接
2. 确认共享文件夹路径正确
3. 检查防火墙设置
4. 验证用户权限

### 问题2：无法连接数据库
**解决方案**：
1. 检查数据库服务器IP和端口
2. 确认数据库服务正在运行
3. 检查数据库用户权限
4. 验证防火墙设置

### 问题3：文件上传失败
**解决方案**：
1. 检查共享文件夹权限
2. 确认网络连接稳定
3. 查看后端服务日志

## 维护说明

### 定期备份
1. 数据库备份
2. 共享文件夹备份
3. 配置文件备份

### 系统监控
1. 监控后端服务运行状态
2. 监控磁盘空间使用情况
3. 监控网络连接状态

## 附录：端口说明

| 服务 | 端口 | 说明 |
|------|------|------|
| MySQL数据库 | 3306 | 数据库服务端口 |
| 后端服务 | 3001 | API服务端口 |
| 文件共享 | 445 | SMB文件共享端口 |

## 附录：默认账号

| 角色 | 用户名 | 密码 | 权限 |
|------|--------|------|------|
| 超级管理员 | admin | 123456 | 所有权限 |
| 客服人员 | CS001 | 123456 | 基本操作权限 |
