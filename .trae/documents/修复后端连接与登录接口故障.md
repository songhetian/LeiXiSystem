## 问题定位
- 前端错误显示 `net::ERR_CONNECTION_REFUSED` 指向 `http://192.168.110.83:3001/api/auth/check-session`，同时伴随 404。
- 服务器端已存在 `POST /api/auth/check-session` 路由（server/index.js:246–286），但连接目标 IP/端口不可达或不正确。
- 前端 API 基址由 `src/utils/apiConfig.js` 决定，当前默认回退为 `'http://192.168.2.31/api'`，实际运行环境可能通过 `VITE_API_BASE_URL` 指向 `192.168.110.83:3001`，与本机 Fastify 开发端口不匹配。

## 修复方案
1. 统一开发环境 API 基址到本机
- 在项目根目录创建或更新 `.env.local`（或 `.env`）添加：
  - `VITE_API_BASE_URL=http://localhost:3001/api`
- 说明：避免指向不可达的内网 IP，确保前端通过本机端口访问后端。

2. 可选：增强 `apiConfig` 的回退逻辑
- 将 `src/utils/apiConfig.js` 的默认值调整为 `http://localhost:3001/api`；或根据 `window.location.hostname` 动态选择：
  - 开发（localhost/127.0.0.1）→ `http://localhost:3001/api`
  - 生产 → 保留环境变量。

3. 确认后端正常启动并监听
- 启动后端：`npm run server` 或通过 `npm run start` 并观察 Fastify 是否在 `0.0.0.0:3001` 监听。
- 若仍异常，继续清理冲突路由（以 `server/routes/quality-inspection.js` 为主）并确保无插件版本不匹配（例如 rate-limit）。

4. 端到端验证
- 前端重新启动 Vite，打开 `http://localhost:5175`。
- 在登录页触发 `POST /api/auth/check-session`（src/pages/Login.jsx:87），应返回 200/hasActiveSession 标志。
- 完成登录流程，验证其它页面请求（例如 `/api/employees`、`/api/knowledge/...`）均能成功。

## 风险与回滚
- 修改 `.env` 仅影响当前开发机；若生产需要内网 IP，请在生产环境单独设置 `VITE_API_BASE_URL`。
- 若必须使用内网 IP（例如 192.168.110.83），请确认后端确实在该主机与端口运行并网络可达，然后恢复指向。

## 接下来我将执行
- 添加/更新 `.env.local` 的 `VITE_API_BASE_URL` 为本机。
- 如需稳妥，修改 `apiConfig` 默认回退为 `http://localhost:3001/api`（开发）、保留生产由环境变量控制。
- 启动并验证后端与前端，确保登录检查与其它 API 正常。